# excel_ai_bot

ربات هوشمند مدیریت اکسل با رابط تلگرام + موتور AI ماژولار.

## نصب

```bash
curl -fsSL https://raw.githubusercontent.com/rezajavadi995/excel_ai_bot/main/install.sh | bash
```

## امنیت توکن و ادمین

- توکن و `ADMIN_ID` فقط یک‌بار از نصاب دریافت می‌شود.
- اطلاعات در فایل محلی سیستم نصب ذخیره می‌شود: `~/.config/excel_ai_bot/secrets.json`
- این فایل خارج از گیت است.
- در اجراهای بعدی، نصاب اطلاعات فعلی را نمایش می‌دهد و تأیید مدیر می‌گیرد:
  - اگر تایید شود نصب ادامه پیدا می‌کند.
  - اگر تایید نشود، فرایند دریافت توکن/ادمین دوباره اجرا می‌شود.

## معماری ماژولار

- `core/`: خواندن، تحلیل و ویرایش اکسل.
- `logic/`: AI client، parser و validator.
- `bot/`: هندلرها و کیبوردهای تلگرام.
- `config/`: بارگذاری امن تنظیمات.

## مثال‌ها

### مثال کاربر
- «ستون `price` رو ۱۰ درصد افزایش بده»
- «ستون `price` رو حذف کن»

### مثال مدیر
- ورود به دکمه `⚙️ مدیریت`
- اجرای عملیات مدیریتی از callback های `admin:*`

### مثال ترمینال
- اجرای مستقیم ربات:
  ```bash
  python bot/main_bot.py
  ```
- اجرای تست‌ها:
  ```bash
  pytest -q
  ```

## موتور AI

نسخه فعلی دارای `RuleBasedAIClient` است که فرمان فارسی را به Blueprint استاندارد JSON تبدیل می‌کند.
این بخش طوری طراحی شده که به‌سادگی می‌توانید بعداً API واقعی LLM را جایگزین کنید.
